<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="wk.voluntary.dept">

	<!-- 봉사부서 전체조회하기 -->
	<select id="selectVolDeptList" parameterType="WkVoluntaryDVO" resultType="WkVoluntaryDVO">
	<include refid="cm.com.pagingTop" />
	<![CDATA[
		SELECT 	DEPT_NO			/* 부서일련번호 */
		      , DEPT_NM			/* 부서명 */
		      , USE_YN			/* 사용유무 */
		      , STR_YMD			/* 시작일자 */
		      , END_YMD			/* 종료일자 */
		   FROM TB_DEPT
	      WHERE DEPT_DIV_CD = 'VOL'
	]]>
	<if test="useYn != null and useYn != ''">
		   <!-- 교인 상태 검색 -->	
		   AND USE_YN = #{useYn}	
	</if>
	<include refid="cm.com.pagingBottom" />
	</select>
	
	<!-- 봉사부서 단건조회하기 -->
	<select id="selectVolDept" parameterType="WkVoluntaryDVO" resultType="WkVoluntaryDVO">
	
	<![CDATA[
		SELECT 	DEPT_NO			/* 부서일련번호 */
		      , DEPT_NM			/* 부서명 */
		      , USE_YN			/* 사용유무 */
		      , STR_YMD			/* 시작일자 */
		      , END_YMD			/* 종료일자 */
		   FROM TB_DEPT
	      WHERE DEPT_NO = #{deptNo}
	]]>
	</select>
	
	<!-- 봉사부서 등록하기 -->
	<insert id="insertVolDept" parameterType="WkVoluntaryDVO">
	<![CDATA[
		INSERT 
		  INTO TB_DEPT
		       (
		       	DEPT_NM				/* 부서이름 */
		      , DEPT_DIV_CD			/* 부서구분코드 */
		      , FRS_REG_NO			/* 최초등록자 */
		      , FRS_REG_DT			/* 최초등록일시 */
		      , LST_MDF_NO			/* 최종수정자 */
		      , LST_MDF_DT			/* 최종수정일시 */
		      , STR_YMD				/* 시작일자 */
		      , END_YMD				/* 종료일자 */
		       )
		VALUES (
				#{volDeptNm}
			  , 'VOL'
			  , #{frsRegNo}
			  , NOW()
			  , #{lstMdfNo}
			  , NOW()
			  , #{strYmd}
			  , #{endYmd}
			  	)
	]]>
	</insert>
	
	<!-- 봉사부서 수정하기(이름) -->
	<update id="updateVolDept" parameterType="WkVoluntaryDVO">
	<![CDATA[
		UPDATE TB_DEPT
		   SET 
		       DEPT_NM = #{volDeptNm}			/* 부서이름 */
		     , LST_MDF_NO = #{lstMdfNo}			/* 최종수정자 */
		     , LST_MDF_DT = NOW()				/* 최종수정일시 */
		     , USE_YN = #{useYn}				/* 사용유무 */
		     , STR_YMD = #{strYmd}				/* 시작일자 */
		     , END_YMD = #{endYmd}				/* 종료일자 */
		 WHERE DEPT_NO = #{deptNo}
	]]>
	</update>
	
	<!-- 검색에 따른 데이터 갯수 가져오기 -->
	<select id="volDeptTotalCnt" parameterType="WkVoluntaryDVO" resultType="int">
	<![CDATA[
	  	SELECT COUNT(*)				
		  FROM TB_DEPT
	     WHERE DEPT_DIV_CD = 'VOL'
	]]>	
	<if test="useYn != null and useYn != ''">
		   <!-- 사용유무 검색 -->
		   AND USE_YN = #{useYn}		
	</if>
	</select>
</mapper>