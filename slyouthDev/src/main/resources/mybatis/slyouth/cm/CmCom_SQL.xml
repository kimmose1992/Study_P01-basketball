<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cm.com">

	<sql id="pagingTop">
		SELECT R1.*
		  FROM (
	</sql>

	<sql id="pagingBottom">
		  	   ) R1
	  ORDER BY 1 DESC
   		 LIMIT #{startDataNo}, #{listSize}
	</sql>

	<select id="selectComboDataList" parameterType="CmComDVO" resultType="CmComDVO">
	<![CDATA[
		SELECT CD_VL AS CODE					/* 코드 */
		     , CD_NM AS CODE_LABEL				/* 코드라벨 */
		     , PRN_CD_VL AS CODE_REF_VL			/* 코드참조값 */
		  FROM TB_CODE
		 WHERE CD_GRP_KEY = #{codeKey}
		   AND USE_YN = 'Y'
	]]>	

	<if test="codeRefKey != null and codeRefKey != ''">
		   <!-- 상위코드그룹 -->	
		   AND PRN_CD_GRP_ID = #{codeRefKey}
	</if>
	
	<if test="codeRefVl != null and codeRefVl != ''">
		   <!-- 상위코드 -->	
		   AND PRN_CD_VL = #{codeRefVl}	
	</if>	   

	</select>
	
	<!-- 교역자 리스트를 가져오는 쿼리입니다. -->
	<select id="selectComboPastorList" parameterType="CmComDVO" resultType="CmComDVO">
		SELECT A.CHR_NO AS CODE	/* 코드 */
			 , CONCAT
			   (A.NAME, ' ', (SELECT CD_NM
	 						      FROM TB_CODE
	 						     WHERE CD_GRP_ID = 'POS_DIV_CD'
	 						       AND CD_VL = A.POS_DIV_CD)
			   ) AS CODE_LABEL	/* 코드라벨 */
		  FROM TB_CHRMGNT A
		 WHERE A.CHR_DIV_CD = 'TRC';
	</select>
	
	
	<!-- 봉사부서 리스트를 가져오는 쿼리입니다. -->
	<select id="selectComboVolDeptList" parameterType="CmComDVO" resultType="CmComDVO">
		SELECT DEPT_NO AS CODE			/* 코드 */
			 , DEPT_NM AS CODE_LABEL	/* 코드라벨 */
		  FROM TB_DEPT
		 WHERE USE_YN = 'Y' 
		   AND DEPT_DIV_CD = 'VOL'
	</select>
</mapper>