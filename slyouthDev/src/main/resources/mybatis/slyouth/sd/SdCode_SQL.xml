<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sd.code">

	<select id="selectCodeTotalDataCnt" parameterType="SdCodeDVO" resultType="int">
	<![CDATA[
		SELECT COUNT(*)
		  FROM TB_CODE A /* TB_공통코드 */
		 WHERE 1=1
	]]>	

	<if test="tskDivCd != null and tskDivCd != ''">
	<!-- 업무구분 -->	
		   AND A.TSK_DIV_CD = #{tskDivCd}	
	</if>

	<if test="cdGrpId != null and cdGrpId != ''">
	<!-- 코드그룹ID -->
		   AND A.CD_GRP_ID LIKE CONCAT('%', #{cdGrpId}, '%')
	</if>
	
	<if test="cdGrpNm != null and cdGrpNm != ''">
	<!-- 코드그룹명 -->
		   AND A.CD_GRP_NM LIKE CONCAT('%', #{cdGrpNm}, '%')
	</if>

	<if test="cdGrpKey != null and cdGrpKey != ''">
	<!-- 코드그룹키 -->
		   AND A.CD_GRP_KEY LIKE CONCAT('%', #{cdGrpKey}, '%')
	</if>
	
	<if test="prnCdGrpId != null and prnCdGrpId != ''">
	<!-- 상위코드그룹ID -->
		   AND A.PRN_CD_GRP_ID LIKE CONCAT('%', #{prnCdGrpId}, '%')	
	</if>
	
	<if test="prnCdVl != null and prnCdVl != ''">
	<!-- 상위코드값 -->
		   AND A.PRN_CD_VL LIKE CONCAT('%', #{prnCdVl}, '%')
	</if>
	
	<if test="cdVl != null and cdVl != ''">
	<!-- 코드값 -->
		   AND A.CD_VL LIKE CONCAT('%', #{cdVl}, '%')
	</if>
	
	<if test="cdNm != null and cdNm != ''">
	<!-- 코드명 -->
		   AND A.CD_NM LIKE CONCAT('%', #{cdNm}, '%')
	</if>
	
	<if test="useYn != null and useYn != ''">
	<!-- 사용여부 -->
		   AND A.USE_YN = #{useYn}	
	</if>
	</select>
	
	<select id="selectCodeList" parameterType="SdCodeDVO" resultType="SdCodeDVO">
	<include refid="cm.com.pagingTop" />
	
	<![CDATA[
		SELECT A.CODE_NO						/* 코드번호 */
			 , A.TSK_DIV_CD						/* 업무구분코드 */
			 , (
			 	SELECT CD_NM
			      FROM TB_CODE
				 WHERE CD_GRP_ID = 'TSK_DIV_CD'
				   AND CD_VL = A.TSK_DIV_CD
			   ) AS TSK_DIV_NM 					/* 업무구분명 */
			 , A.CD_GRP_ID						/* 코드그룹ID */
			 , A.CD_GRP_NM						/* 코드그룹명 */
			 , A.CD_GRP_KEY						/* 코드그룹키 */
			 , A.PRN_CD_GRP_ID					/* 상위코드그룹ID */
			 , A.PRN_CD_VL						/* 상위코드값 */
			 , A.CD_VL							/* 코드값 */
			 , A.CD_NM							/* 코드명 */
			 , A.CD_ORD							/* 코드순서 */
			 , A.REMARK							/* 코드비고 */
			 , A.USE_YN							/* 사용여부 */
			 , A.LST_MDF_DT						/* 최종수정일시 */
		  FROM TB_CODE A 						/* TB_공통코드 */
		 WHERE 1=1
	]]>	

	<if test="tskDivCd != null and tskDivCd != ''">
	<!-- 업무구분 -->	
		   AND A.TSK_DIV_CD = #{tskDivCd}	
	</if>
	
	<if test="cdGrpId != null and cdGrpId != ''">
	<!-- 코드그룹ID -->
		   AND A.CD_GRP_ID LIKE CONCAT('%', #{cdGrpId}, '%')
	</if>
	
	<if test="cdGrpNm != null and cdGrpNm != ''">
	<!-- 코드그룹명 -->
		   AND A.CD_GRP_NM LIKE CONCAT('%', #{cdGrpNm}, '%')
	</if>

	<if test="cdGrpKey != null and cdGrpKey != ''">
	<!-- 코드그룹키 -->
		   AND A.CD_GRP_KEY LIKE CONCAT('%', #{cdGrpKey}, '%')
	</if>
	
	<if test="prnCdGrpId != null and prnCdGrpId != ''">
	<!-- 상위코드그룹ID -->
		   AND A.PRN_CD_GRP_ID LIKE CONCAT('%', #{prnCdGrpId}, '%')	
	</if>
	
	<if test="prnCdVl != null and prnCdVl != ''">
	<!-- 상위코드값 -->
		   AND A.PRN_CD_VL LIKE CONCAT('%', #{prnCdVl}, '%')
	</if>
	
	<if test="cdVl != null and cdVl != ''">
	<!-- 코드값 -->
		   AND A.CD_VL LIKE CONCAT('%', #{cdVl}, '%')
	</if>
	
	<if test="cdNm != null and cdNm != ''">
	<!-- 코드명 -->
		   AND A.CD_NM LIKE CONCAT('%', #{cdNm}, '%')
	</if>
	
	<if test="useYn != null and useYn != ''">
	<!-- 사용여부 -->
		   AND A.USE_YN = #{useYn}	
	</if>
	
	<include refid="cm.com.pagingBottom" />
	</select>
	
	<select id="selectCodeDetail" parameterType="SdCodeDVO" resultType="SdCodeDVO">
	<![CDATA[
		SELECT REG_SEQ			/* 등록일련번호 */
			 , TSK_DIV_CD		/* 업무구분코드 */
			 , CD_GRP_ID		/* 코드그룹ID */
			 , CD_GRP_NM		/* 코드그룹명 */
			 , PRN_CD_GRP_ID	/* 상위코드그룹ID */
			 , PRN_CD_VL		/* 상위코드값 */
			 , CD_VL			/* 코드값 */
			 , CD_NM			/* 코드명 */
			 , CD_ORD			/* 코드순서 */
			 , CD_RMK			/* 코드비고 */
			 , USE_YN			/* 사용여부 */
			 , FRS_REG_DT		/* 최초등록일시 */
			 , LST_MDF_DT		/* 최종수정일시 */
		  FROM TB_CODE
		 WHERE REG_SEQ = #{regSeq}
	]]>
	</select>	
</mapper>
