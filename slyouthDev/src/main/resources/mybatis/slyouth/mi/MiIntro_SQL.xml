<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mi.intro">
	<!-- 메인 소개 조회 -->
	<select id="selectMainIntro" resultType="MiIntroDVO">
	<![CDATA[
		SELECT INTRO_DIV_CD			/* 소개구분코드 */
			 , INTRO_NO				/* 소개번호 */
			 , TITLE				/* 타이틀 */
			 , SUBJECT				/* 주제 */
			 , CONTENT				/* 내용 */	
		  FROM TB_INTRO
		 WHERE INTRO_DIV_CD = "MAI"
	]]>	
	</select>
	
	<!-- 메인 소개 수정 -->
	<update id="updateMainIntro" parameterType="MiIntroDVO">
	<![CDATA[
		UPDATE TB_INTRO SET
			   TITLE = #{title}				/* 타이틀 */
			 , SUBJECT = #{subject}			/* 주제 */
			 , CONTENT = #{content}			/* 내용 */		
		 WHERE INTRO_DIV_CD = "MAI"
	]]>	
	</update>
	
	<!-- 메인 공지사항 리스트 조회 -->
	<select id="selectMainNotice" resultType="MiIntroDVO">
	<![CDATA[
		SELECT INTRO_DIV_CD			/* 소개구분코드 */
			 , INTRO_NO				/* 소개번호 */
			 , TITLE				/* 타이틀 */
			 , SUBJECT				/* 주제 */
			 , CONTENT				/* 내용 */	
		  FROM TB_INTRO
		 WHERE INTRO_DIV_CD = "MAI"
	]]>	
	</select>
	
	<!-- 인사말을 조회하는 쿼리입니다. -->
	<select id="greeting" resultType="MiIntroDVO">
	<![CDATA[
		SELECT SUBJECT						/* 주제 */
			 , CONTENT						/* 내용 */
		  FROM TB_INTRO
		 WHERE INTRO_DIV_CD = 'GRT'
	]]> 
	</select>

	<!-- 소개구분코드가 인사말의 주제와 내용을 수정하는 쿼리입니다. -->
	<update id="greetingUpdate" parameterType="MiIntroDVO">
	<![CDATA[
		UPDATE TB_INTRO 
		   SET SUBJECT = #{subject}			/* 주제 */
			 , CONTENT = #{content}			/* 내용 */
		 WHERE INTRO_DIV_CD = 'GRT'
	]]>	
	</update>
	
	<!-- 예배안내를 조회하는 쿼리입니다. -->
	<select id="selectWorshipInfo" resultType="MiIntroDVO">
	<![CDATA[
		SELECT INTRO_NO				/* 소개번호 */
			 , INTRO_DIV_CD			/* 소개구분코드 */
			 , REMARK				/* 비고 */
			 , CONTENT				/* 내용 */	
		  FROM TB_INTRO
		 WHERE INTRO_DIV_CD = "WSI"
	]]> 
	</select>
	
	<!-- 예배안내를 수정하는 쿼리입니다. -->
	<update id="worshipInfoUpdate" parameterType="MiIntroDVO">
	<![CDATA[
		UPDATE TB_INTRO 
		   SET REMARK = #{remark}			/* 예배정보 */
			 , CONTENT = #{content}			/* 내용 */	
		 WHERE INTRO_DIV_CD = #{introDivCd}
	]]>	
	</update>
	
	<!-- 새가족반소개 기본정보 조회 -->
	<select id="selectNewcomerInfo" parameterType="MiIntroDVO" resultType="MiIntroDVO">
	<![CDATA[
			SELECT A.INTRO_NO		/* 소개번호 */
				 , A.INTRO_DIV_CD	/* 소개구분코드 */
				 , A.SUBJECT		/* 주제 */
				 , A.TITLE			/* 제목 */
				 , A.CONTENT		/* 내용 */
				 , A.REMARK			/* 비고 */
				 , B.FILE_NO		/* 파일번호 */
				 , A.FRS_REG_NO		/* 최초등록자번호 */
				 , A.FRS_REG_DT		/* 최초등록일시 */
				 , A.LST_MDF_NO		/* 최종수정자번호 */
				 , A.LST_MDF_DT		/* 최종수정일시 */
			  FROM TB_INTRO A
   LEFT OUTER JOIN TB_FILE B
   				ON A.INTRO_NO = B.REF_NO
   			   AND A.INTRO_DIV_CD = B.REF_DIV_CD
   			   AND B.REF_TB_KEY = #{slyouthTbKey}
		 	 WHERE A.INTRO_DIV_CD = 'NMI'
	]]>
	</select>		
</mapper>