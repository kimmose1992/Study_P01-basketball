<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<th:block th:replace="fragments/cm/header :: fragment-header" />
		<script>
			$(document).ready(function(){
				
				/**
				 * [목록] 버튼 클릭 이벤트
				 * - 말씀후기 목록 조회 페이지로 이동한다.
				 */
				$("#reviewList").click(function(){
					location.href = "/ws/reviewList";;
				});
			});
			
			/**
			 * [수정] 버튼 클릭 이벤트
			 * - 말씀후기를 수정하는 페이지로 이동한다.
			 */
			function reviewEdit(reviewDVO){
				
				var params = {};
				params.cmntyNo = reviewDVO.cmntyNo;
				params.editDivCd = "U";
				
				com.movePagePost("/ws/reviewEdit", params);
			}
			
			/**
			 * [삭제] 버튼 클릭 이벤트
			 * - 말씀후기를 삭제한다.(삭제는 교역자/임원/관리자만 가능하다)
			 */
			function reviewDelete(reviewDVO){
				var params = {};
				params.cmntyNo = reviewDVO.cmntyNo;
				
				var deleteConfirm = confirm("삭제하시겠습니까?");
				if(deleteConfirm){
					com.loadAjaxPost("/ws/reviewDel", params, cbReviewDelete)
				}
			}
			
			/**
			 * reviewDelete callback 메소드
			 * - 삭제시 callback 처리되는 함수이다.
			 */
			 cbReviewDelete = function(res){
				if(res != 0){
					alert("삭제되었습니다.");
					location.href = "/ws/reviewList";
				}else {
					alert("DB 에러가 발생하였습니다.");
					return;
				}
			}
		</script>
	</head>
	<body>
		<!-- asideMenu -->
		<div th:replace="fragments/cm/layout/asideMenu :: fragment-asideMenu"></div>
		<!-- asideMenu -->
			
			<!-- header -->
			<div th:replace="fragments/cm/layout/headerMenu :: fragment-headerMenu"></div>
			<!-- header -->
			
			<div id="wrap">
				<div id="section_wrap">
					
					<!-- worshipVisual -->
					<div th:replace="fragments/cm/layout/worshipVisual :: fragment-worshipVisual"></div>
					<!-- worshipVisual -->
					
					<section class="community_list_wrap">
	        			<div class="community_list_title" id="view_details">
							<p>예배와 말씀</p>
	                		<h2>말씀후기</h2>
	            		</div>
						<div class="view_details_content">
							<form role="form" th:object=${returnSVO.wsReviewDVO}>
								<div class="view_details_content_title">
									<h2 th:text="*{title}"></h2>
									<p th:text="*{name}"></p>
								</div>
								<div class="view_details_content_info">
									<div>
										<p>조회수 :</p><span th:text="*{viewCnt}"></span>
									</div>
									<div>
										<p>수정일시 :</p><span th:text="${#temporals.format(returnSVO.wsReviewDVO.lstMdfDt, 'yyyy-MM-dd HH:mm')}"></span>
									</div>
								</div>
								<div class="view_details_Contents">
									<p th:utext="*{content}"></p>
								</div>
								<div class="view_details_content_btn_wrap">
									<div class="next_generation_info_delete_modifications">	
										<input type="button" th:onclick="reviewEdit([[ ${returnSVO.wsReviewDVO} ]])" th:value="|수정|" class="Btn" >
										<input type="button" th:onclick="reviewDelete([[ ${returnSVO.wsReviewDVO} ]])" th:value="|삭제|" class="Btn" >
										<input type="button" id="reviewList" class="Btn" th:value="|목록|">
									</div>
								</div>
							</form>
						</div>
					</section>
				</div>
				
				<!-- footer -->
				<div th:replace="fragments/cm/layout/footer :: fragment-footer"></div>
	            <!-- footer -->
			</div>
	</body>
</html>